<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="Add interactive capabilities to your dashboard, such as controls that allow you to apply dashboard-level filtes, and drilldowns that allow you to navigate to other dashboards and external websites.">
<meta name="keywords" content="administrator, analyst, concept, task, analyze, dashboard, controls, drilldowns">
<title>Reporting and security | Kibana Guide [master] | Elastic</title>
<link rel="home" href="index.html" title="Kibana Guide [master]"/>
<link rel="up" href="configuring-reporting.html" title="Reporting configuration"/>
<link rel="prev" href="configuring-reporting.html" title="Reporting configuration"/>
<link rel="next" href="securing-reporting.html" title="Secure the reporting endpoints"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/master"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Kibana Guide [master]</a></span>
»
<span class="breadcrumb-link"><a href="reporting-getting-started.html">Reporting</a></span>
»
<span class="breadcrumb-link"><a href="configuring-reporting.html">Reporting configuration</a></span>
»
<span class="breadcrumb-node">Reporting and security</span>
</div>
<div class="navheader">
<span class="prev">
<a href="configuring-reporting.html">« Reporting configuration</a>
</span>
<span class="next">
<a href="securing-reporting.html">Secure the reporting endpoints »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="secure-reporting"></a>Reporting and security<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/reporting.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<p>Reporting operates by creating and updating documents in Elasticsearch in response to
user actions in Kibana.</p>
<p>To use reporting features with security features enabled, you need to
<a class="xref" href="using-kibana-with-security.html" title="Configure security in Kibana">configure security in Kibana</a>.
If you are automatically generating reports with
<a href="/guide/en/elasticsearch/reference/master/xpack-alerting.html" class="ulink" target="_top">Watcher</a>, you also need to configure Watcher
to trust the Kibana server&#8217;s certificate.</p>
<p><a id="reporting-app-users"></a>Access to reporting features is limited to privileged users. In older versions of Kibana, you could only grant
users the privilege by assigning them the <code class="literal">reporting_user</code> role in Elasticsearch. In 7.14 and above, you have
the option to create your own roles that grant access to reporting features using <a class="xref" href="kibana-privileges.html" title="Kibana privileges">Kibana privileges</a>.</p>
<p>It is recommended that you set <code class="literal">xpack.reporting.roles.enabled: false</code> in your kibana.yml to begin using Kibana
privileges. This will allow users to only see Reporting widgets in applications when they have privilege to use
them.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The default value of <code class="literal">xpack.reporting.roles.enabled</code> is <code class="literal">true</code> for 7.x versions of Kibana. To migrate users to the
new method of securing access to <span class="strong strong"><strong>Reporting</strong></span>, you must explicitly set <code class="literal">xpack.reporting.roles.enabled: false</code> in
<code class="literal">kibana.yml</code>. In the next major version of Kibana, having this set to <code class="literal">false</code> will be the only valid configuration.</p>
</div>
</div>
<p>This document discusses how to create a role that grants access to reporting features using the new method of
Kibana application privileges.</p>
<h3><a id="reporting-roles-management-ui"></a>Create the role in the <code class="literal">native</code> realm<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/reporting.asciidoc">edit</a></h3>
<p>To create roles, use the <span class="strong strong"><strong>Roles</strong></span> UI or <a class="xref" href="secure-reporting.html#reporting-roles-user-api" title="With the user API">user API</a>. This example shows how to
create a role that grants reporting feature privileges in Kibana applications.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the main menu, then click <span class="strong strong"><strong>Stack Management &gt; Roles</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Create role</strong></span>, then give the role a name, for example, <code class="literal">custom_reporting_user</code>.
</li>
<li class="listitem">
<p>Specify the indices and privileges.</p>
<p>Access to data is an index-level privilege, so in <span class="strong strong"><strong>Create role</strong></span>,
add a line for each index that contains the data for the report and give each
index <code class="literal">read</code> and <code class="literal">view_index_metadata</code> privileges.
For more information, see <a href="/guide/en/elasticsearch/reference/master/security-privileges.html" class="ulink" target="_top">Security privileges</a>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="user/security/images/reporting-privileges-example.png" alt="Reporting privileges">
</div>
</div>
</li>
<li class="listitem">
<p>Add space privileges for the Kibana applications that allow access to the reporting options.</p>
<p>To allow users to create CSV reports in <span class="strong strong"><strong>Discover</strong></span>, or PDF reports in <span class="strong strong"><strong>Canvas</strong></span>,
<span class="strong strong"><strong>Visualize Library</strong></span>, and <span class="strong strong"><strong>Dashboard</strong></span>, click  <span class="strong strong"><strong>Add Kibana privilege</strong></span> for each application,
then select the privileges to generate
reports. For example, select <span class="strong strong"><strong>All</strong></span> privileges for all features, or <span class="strong strong"><strong>Customize</strong></span> to grant
the privilege to generate reports for only specific applications.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="user/security/images/reporting-custom-role.png" alt="Reporting custom role">
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Granting users access to reporting features in any application also grants them access to manage their reports in <span class="strong strong"><strong>Stack Management &gt; Reporting</strong></span>.</p>
</div>
</div>
</li>
<li class="listitem">
Save your new role.
</li>
<li class="listitem">
Open the main menu, then click <span class="strong strong"><strong>Stack Management &gt; Users</strong></span>, add a new user, and assign the user
your new <code class="literal">custom_reporting_user</code> role.
</li>
</ol>
</div>
<h4><a id="reporting-roles-user-api"></a>With the user API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/reporting.asciidoc">edit</a></h4>
<p>This example uses the <a href="/guide/en/elasticsearch/reference/master/security-api-put-role.html" class="ulink" target="_top">role API</a> to create a role that
grants the privilege to generate reports in <span class="strong strong"><strong>Canvas</strong></span>, <span class="strong strong"><strong>Discover</strong></span>, <span class="strong strong"><strong>Visualize Library</strong></span>, and <span class="strong strong"><strong>Dashboard</strong></span>.
This role is meant to be granted to users in combination with other roles that grant read access
to the data in Elasticsearch, and at least read access in the applications
where they&#8217;ll generate reports.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role/custom_reporting_user
{
  metadata: {},
  elasticsearch: { cluster: [], indices: [], run_as: [] },
  kibana: [
    {
      base: [],
      feature: {
        dashboard: [
          'generate_report', <a id="CO41-1"></a><i class="conum" data-value="1"></i>
          'download_csv_report' <a id="CO41-2"></a><i class="conum" data-value="2"></i>
        ],
        discover: ['generate_report'], <a id="CO41-3"></a><i class="conum" data-value="3"></i>
        canvas: ['generate_report'], <a id="CO41-4"></a><i class="conum" data-value="4"></i>
        visualize: ['generate_report'], <a id="CO41-5"></a><i class="conum" data-value="5"></i>
      },
      spaces: ['*'],
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/10.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO41-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Grants access to generate PNG and PDF reports in <span class="strong strong"><strong>Dashboard</strong></span>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO41-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Grants access to download CSV files from saved search panels in <span class="strong strong"><strong>Dashboard</strong></span>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO41-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Grants access to generate CSV reports from saved searches in <span class="strong strong"><strong>Discover</strong></span>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO41-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Grants access to generate PDF reports in <span class="strong strong"><strong>Canvas</strong></span>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO41-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Grants access to generate PNG and PDF reports in <span class="strong strong"><strong>Visualize Library</strong></span>.</p>
</td>
</tr>
</table>
</div>
<h3><a id="_when_using_an_external_provider"></a>When using an external provider<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/reporting.asciidoc">edit</a></h3>
<p>If you are using an external identity provider, such as
LDAP or Active Directory, you can either assign
roles on a per user basis, or assign roles to groups of users. By default, role
mappings are configured in
<a href="/guide/en/elasticsearch/reference/master/mapping-roles.html" class="ulink" target="_top"><code class="literal">config/role_mapping.yml</code></a>.
For example, the following snippet assigns the user named Bill Murray the
<code class="literal">kibana_admin</code> and <code class="literal">reporting_user</code> roles:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">kibana_admin:
  - "cn=Bill Murray,dc=example,dc=com"
reporting_user:
  - "cn=Bill Murray,dc=example,dc=com"</pre>
</div>
<h3><a id="_with_a_custom_index"></a>With a custom index<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/reporting.asciidoc">edit</a></h3>
<p>If you are using a custom index,
the <code class="literal">xpack.reporting.index</code> setting should begin
with <code class="literal">.reporting-*</code>. The default Kibana system user has
<code class="literal">all</code> privileges against the <code class="literal">.reporting-*</code> pattern of indices.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">xpack.reporting.index: '.reporting-custom-index'</pre>
</div>
<p>If you use a different pattern for the <code class="literal">xpack.reporting.index</code> setting,
you must create a custom <code class="literal">kibana_system</code> user with appropriate access to the index, similar
to the following:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the main menu, then click <span class="strong strong"><strong>Stack Management &gt; Roles</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Create role</strong></span>, then name the role <code class="literal">custom-reporting-user</code>.
</li>
<li class="listitem">
Specify the custom index and assign it the <code class="literal">all</code> index privilege.
</li>
<li class="listitem">
Open the main menu, then click <span class="strong strong"><strong>Stack Management &gt; Users</strong></span> and create a new user with
the <code class="literal">kibana_system</code> role and the <code class="literal">custom-reporting-user</code> role.
</li>
<li class="listitem">
<p>Configure Kibana to use the new account:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">elasticsearch.username: 'custom_kibana_system'</pre>
</div>
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Setting a custom index for <span class="strong strong"><strong>Reporting</strong></span> is not supported in the next major version of Kibana.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="configuring-reporting.html">« Reporting configuration</a>
</span>
<span class="next">
<a href="securing-reporting.html">Secure the reporting endpoints »</a>
</span>
</div>
</div>
</body>
</html>

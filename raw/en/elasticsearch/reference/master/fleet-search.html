<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Fleet search API | Elasticsearch Guide [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="fleet-apis.html" title="Fleet APIs"/>
<link rel="prev" href="get-global-checkpoints.html" title="Get global checkpoints API"/>
<link rel="next" href="find-structure.html" title="Find structure API"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
»
<span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
»
<span class="breadcrumb-link"><a href="fleet-apis.html">Fleet APIs</a></span>
»
<span class="breadcrumb-node">Fleet search API</span>
</div>
<div class="navheader">
<span class="prev">
<a href="get-global-checkpoints.html">« Get global checkpoints API</a>
</span>
<span class="next">
<a href="find-structure.html">Find structure API »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="fleet-search"></a>Fleet search API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/fleet/fleet-search.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>The purpose of the fleet search api is to provide a search api where the search
will only be executed after provided checkpoint has been processed and is visible
for searches inside of Elasticsearch.</p>
<p>This API is experimental and only intended for internal use by fleet server.</p>
<h2><a id="wait-for-checkpoint-functionality"></a>Wait for checkpoint functionality<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/fleet/fleet-search.asciidoc">edit</a></h2>
<p>The fleet search API provides all of the expected functionality of the normal
Elasticsearch search API. However, it also supports the optional parameter
<code class="literal">wait_for_checkpoints</code>. This parameter is a list of sequence number checkpoints.
When this parameter is present, the search will only be executed on local shards
when the relevant sequence number checkpoint is visible for search after a refresh.
The checkpoints are indexed by shard.</p>
<p>If a timeout occurs before the the checkpoint has been refreshed into Elasticsearch,
the search request will timeout.</p>
<p>The fleet search API only supports searches against a single index.</p>
<h2><a id="fleet-search-partial-responses"></a>Allow partial results<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/fleet/fleet-search.asciidoc">edit</a></h2>
<p>By default, the Elasticsearch search api will allow <a class="xref" href="search-search.html#search-partial-responses">partial search results</a>.
With this fleet API, it is common to configure this to be <code class="literal">false</code> or to check in the response
to ensure each shard search was successful. If these precautions are not taken, it is
possible for search results to be successfully returned even if one or more shards
timed out.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="fleet-search-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/fleet/fleet-search.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /&lt;index&gt;/_fleet/_search</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="fleet-search-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/fleet/fleet-search.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;index&gt;</code>
</span>
</dt>
<dd>
(Required, string)
A single index or index alias that resolves to a single index.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="fleet-search-api-query-parms"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/fleet/fleet-search.asciidoc">edit</a></h3>
</div></div></div>
<p>This API supports all the same <a class="xref" href="search-search.html#search-search-api-query-params" title="Query parameters">query params</a> as the normal search api.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">wait_for_checkpoints</code>
</span>
</dt>
<dd>
(Optional, list) A comma separated list of checkpoints. When configured, the search API will
only be executed on a shard after the relevant checkpoint has become visible for search.
Defaults to an empty list which will cause Elasticsearch to immediately execute the search.
</dd>
<dt>
<span class="term">
<code class="literal">allow_partial_search_results</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">true</code>, returns partial results if there are shard request timeouts or
<a class="xref" href="docs-replication.html#shard-failures" title="Shard failures">shard failures</a>. If <code class="literal">false</code>, returns an error with
no partial results. Defaults to <code class="literal">true</code>.
</p>
<p>To override the default for this field, set the
<code class="literal">search.default_allow_partial_results</code> cluster setting to <code class="literal">false</code>.</p>
</dd>
</dl>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="get-global-checkpoints.html">« Get global checkpoints API</a>
</span>
<span class="next">
<a href="find-structure.html">Find structure API »</a>
</span>
</div>
</div>
</body>
</html>

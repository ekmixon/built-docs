<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Elasticsearch breaking changes | Installation and Upgrade Guide [master] | Elastic</title>
<link rel="home" href="index.html" title="Installation and Upgrade Guide [master]"/>
<link rel="up" href="elastic-stack-breaking-changes.html" title="Breaking changes"/>
<link rel="prev" href="beats-breaking-changes.html" title="Beats breaking changes"/>
<link rel="next" href="elasticsearch-hadoop-breaking-changes.html" title="Elasticsearch Hadoop breaking changes"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Installation and Upgrade/master"/>
<meta name="DC.subject" content="Elastic Stack"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Installation and Upgrade Guide [master]</a></span>
»
<span class="breadcrumb-link"><a href="elastic-stack-breaking-changes.html">Breaking changes</a></span>
»
<span class="breadcrumb-node">Elasticsearch breaking changes</span>
</div>
<div class="navheader">
<span class="prev">
<a href="beats-breaking-changes.html">« Beats breaking changes</a>
</span>
<span class="next">
<a href="elasticsearch-hadoop-breaking-changes.html">Elasticsearch Hadoop breaking changes »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="elasticsearch-breaking-changes"></a>Elasticsearch breaking changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/install-upgrade/breaking.asciidoc">edit</a></h2>
</div></div></div>

<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Coming in 8.0.0.</p>
</div>
</div>
<p>This list summarizes the most important breaking changes in Elasticsearch 8.0.0. For
the complete list, go to <a href="/guide/en/elasticsearch/reference/master/breaking-changes.html" class="ulink" target="_top">Elasticsearch breaking changes</a>.</p>
<details>
<summary class="title">Indices created in Elasticsearch 6.x and earlier versions are not supported.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Elasticsearch 8.0 can read indices created in version 7.0 or above. An
Elasticsearch 8.0 node will not start in the presence of indices created in a
version of Elasticsearch before 7.0.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Reindex indices created in Elasticsearch 6.x or before with Elasticsearch 7.x if they need to be carried forward to  Elasticsearch 8.x.</p>
</div>
</details>
<details>
<summary class="title">REST API endpoints containing <code class="literal">_xpack</code> have been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In 7.0, we deprecated REST endpoints that contain <code class="literal">_xpack</code> in their path. These
endpoints are now removed in 8.0. Each endpoint that was deprecated and removed
is replaced with a new endpoint that does not contain <code class="literal">_xpack</code>. As an example,
<code class="literal">/{index}/_xpack/graph/_explore</code> is replaced by <code class="literal">/{index}/_graph/explore</code>.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the replacement REST API endpoints. Requests submitted to the <code class="literal">_xpack</code>
API endpoints will return an error.</p>
</div>
</details>
<details id="percentile-duplication">
<summary class="title">The <code class="literal">percentiles</code> aggregation&#8217;s <code class="literal">percents</code> parameter no longer supports duplicate values.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
If you specify the <code class="literal">percents</code> parameter with the
<a href="/guide/en/elasticsearch/reference/master/search-aggregations-metrics-percentile-aggregation.html" class="ulink" target="_top"><code class="literal">percentiles</code> aggregation</a>,
its values must be unique. Otherwise, an exception occurs.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use unique values in the <code class="literal">percents</code> parameter of the <code class="literal">percentiles</code> aggregation.
Requests containing duplicate values in the <code class="literal">percents</code> parameter will return
an error.</p>
</div>
</details>
<details>
<summary class="title">The <code class="literal">in_flight_requests</code> stat has been renamed <code class="literal">inflight_requests</code> in logs and diagnostic APIs.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The name of the in flight requests circuit breaker in log output and diagnostic APIs (such as the node stats API) changes from <code class="literal">in_flight_requests</code> to <code class="literal">inflight_requests</code> to align it with the name of the corresponding settings.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Update your workflow and applications to use the <code class="literal">inflight_requests</code> stat in
place of <code class="literal">in_flight_requests</code>.</p>
</div>
</details>
<details>
<summary class="title">Java-time date formats replace joda-time formats.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In 7.0, Elasticsearch switched from joda time to java time for date-related parsing,
formatting, and calculations. Indices created in 7.0 and later versions are
already required to use mappings with java-time date formats. However,
earlier indices using joda-time formats must be reindexed to use
mappings with java-time formats.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
For a detailed migration guide, see the <a href="/guide/en/elasticsearch/reference/master/migrate-to-java-time.html" class="ulink" target="_top">Java
time migration guide</a>.</p>
</div>
</details>
<details id="geo-shape-strategy">
<summary class="title">Several <code class="literal">geo_shape</code> mapping parameters have been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The following <code class="literal">geo_shape</code> mapping parameters were deprecated in 6.6:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">tree</code>
</li>
<li class="listitem">
<code class="literal">tree_levels</code>
</li>
<li class="listitem">
<code class="literal">strategy</code>
</li>
<li class="listitem">
<code class="literal">distance_error_pct</code>
</li>
</ul>
</div>
<p>These parameters have been removed in 8.0.0.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
In 8.0, you can no longer create mappings that include these parameters.
However, 7.x indices that use these mapping parameters will continue to work.</p>
</div>
</details>
<details>
<summary class="title">Java 11 is required.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Java 11 or higher is now required to run Elasticsearch and any of its command
line tools.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use Java 11 or higher. Attempts to run Elasticsearch 8.0 using earlier Java versions will
fail.</p>
</div>
</details>
<details>
<summary class="title">JAVA_HOME is no longer supported.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
<code class="literal">JAVA_HOME</code> is no longer supported to set the path for the JDK. Instead, use
the bundled JDK (preferable), or set <code class="literal">ES_JAVA_HOME</code>.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the bundled JDK (preferable), or set <code class="literal">ES_JAVA_HOME</code>. <code class="literal">JAVA_HOME</code> will be
ignored.</p>
</div>
</details>
<details id="id-field-data">
<summary class="title">Aggregating and sorting on <code class="literal">_id</code> is disallowed by default.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Previously, it was possible to aggregate and sort on the built-in <code class="literal">_id</code> field
by loading an expensive data structure called fielddata. This was deprecated
in 7.6 and is now disallowed by default in 8.0.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Aggregating and sorting on <code class="literal">_id</code> should be avoided. As an alternative, the
<code class="literal">_id</code> field&#8217;s contents can be duplicated into another field with docvalues
enabled (note that this does not apply to auto-generated IDs).</p>
</div>
</details>
<details>
<summary class="title">The realm <code class="literal">order</code> setting is now required.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">xpack.security.authc.realms.{type}.{name}.order</code> setting is now required and must be
specified for each explicitly configured realm. Each value must be unique.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
The cluster will fail to start if the requirements are not met.</p>
<p>For example, the following configuration is invalid:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.realms.kerberos.kerb1:
  keytab.path: es.keytab
  remove_realm_name: false</pre>
</div>
<p>And must be configured as:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.realms.kerberos.kerb1:
  order: 0
  keytab.path: es.keytab
  remove_realm_name: false</pre>
</div>
</div>
</details>
<details id="audit-logs-are-rolled-over-and-archived-by-size">
<summary class="title">Audit logs are rolled-over and archived by size.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In addition to the existing daily rollover, the security audit logs are
now rolled-over by disk size limit as well. Moreover, the rolled-over logs
are also gzip compressed.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
The names of rolled over audit logfiles (but not the name of the current log)
have changed.
If you&#8217;ve setup automated tools to consume these files, you must configure them
to use the new names and to possibly account for gzip archives instead of plaintext.
The Docker build of Elasticsearch is not affected since it logs on stdout where
rollover is not performed.</p>
</div>
</details>
<details>
<summary class="title">Several <code class="literal">transport</code> settings have been replaced.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The following settings have been deprecated in 7.x and removed in 8.0. Each setting has a replacement
setting that was introduced in 6.7.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">transport.tcp.port</code> replaced by <code class="literal">transport.port</code>
</li>
<li class="listitem">
<code class="literal">transport.tcp.compress</code> replaced by <code class="literal">transport.compress</code>
</li>
<li class="listitem">
<code class="literal">transport.tcp.connect_timeout</code> replaced by <code class="literal">transport.connect_timeout</code>
</li>
<li class="listitem">
<code class="literal">transport.tcp_no_delay</code> replaced by <code class="literal">transport.tcp.no_delay</code>
</li>
<li class="listitem">
<code class="literal">transport.profiles.profile_name.tcp_no_delay</code> replaced by <code class="literal">transport.profiles.profile_name.tcp.no_delay</code>
</li>
<li class="listitem">
<code class="literal">transport.profiles.profile_name.tcp_keep_alive</code> replaced by <code class="literal">transport.profiles.profile_name.tcp.keep_alive</code>
</li>
<li class="listitem">
<code class="literal">transport.profiles.profile_name.reuse_address</code> replaced by <code class="literal">transport.profiles.profile_name.tcp.reuse_address</code>
</li>
<li class="listitem">
<code class="literal">transport.profiles.profile_name.send_buffer_size</code> replaced by <code class="literal">transport.profiles.profile_name.tcp.send_buffer_size</code>
</li>
<li class="listitem">
<code class="literal">transport.profiles.profile_name.receive_buffer_size</code> replaced by <code class="literal">transport.profiles.profile_name.tcp.receive_buffer_size</code>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the replacement settings. Discontinue use of the removed settings.
Specifying the removed settings in <code class="literal">elasticsearch.yml</code> will result in an error
on startup.</p>
</div>
</details>
</div>
<div class="navfooter">
<span class="prev">
<a href="beats-breaking-changes.html">« Beats breaking changes</a>
</span>
<span class="next">
<a href="elasticsearch-hadoop-breaking-changes.html">Elasticsearch Hadoop breaking changes »</a>
</span>
</div>
</div>
</body>
</html>
